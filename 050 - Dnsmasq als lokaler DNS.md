# Dnsmasq als lokaler DNS-Resolver

Der Betrieb des RaspPi innerhalb des lokalen Netzwerkes und die Anbindung an das Internet
wurden in den vorherigen Kapiteln sicher gestellt. Ab hier kann er mit einfachen
Schritten zum Arbeitstier ausgebaut werden, denn im Normalfall können mit einer soliden Grundkonfiguration neue Dienste problemlos ins Setup eingefügt werden.

Mit dem Konsolenbefehl
```
$ sudo apt install dnsmasq
```
bekommt der Minirechner zuerst einmal einen DNS-Server spendiert.
Systemweite Namensauflösungen  werden ab sofort von ihm behandelt:
```
$ cat /etc/resolve.conf
# Generated by resolvconf
nameserver 127.0.0.1
```
Die im ersten Kapitel selbst eingetragenen Resolver werden von dnsmasq automatisch als eigene Forwarder verwendet:
```
$ cat /var/run/dnsmasq/resolv.conf 
# Generated by resolvconf
nameserver 8.8.8.8
nameserver 2001:4860:4860::8888
nameserver 8.8.4.4
nameserver 2001:4860:4860::8844
```
Außerdem ist der DNS-Server (dnsmasq) ab sofort über die IP-Adressen 192.168.0.100 und 192.168.100.100 am Port 53 erreichbar:
```
fremder@rechner:~$ dig @192.168.100.100 +header-only

; <<>> DiG 9.11.3-1ubuntu1.11-Ubuntu <<>> @192.168.100.100 +header-only
; (1 server found)
;; global options: +cmd
;; Got answer:
;; ->>HEADER<<- opcode: QUERY, status: FORMERR, id: 46726
;; flags: qr rd ra; QUERY: 0, ANSWER: 0, AUTHORITY: 0, ADDITIONAL: 0

;; WARNING: EDNS query returned status FORMERR - retry with '+noedns'

;; Query time: 17 msec
;; SERVER: 192.168.100.100#53(192.168.100.100)
;; WHEN: Sun May 24 22:10:44 CEST 2020
;; MSG SIZE  rcvd: 12
```
Die zweite Komponente von `dnsmasq` ist ein DHCP-Server.
Diese ist standardmäßig deaktiviert.
